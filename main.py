from data_loader import load_data
from preprocess import preprocess_data
from train_model import train_model, save_model
import joblib

if __name__ == '__main__':
    print("Loading data...")
    # Load and preprocess data
    data = load_data('vulnerabilities.csv', 'exploits.csv')
    print("Data loaded successfully.")
    
    print("Preprocessing data...")
    X, y = preprocess_data(data)
    print("Data preprocessing completed.")
    
    print("Training the model...")
    # Train the model
    model = train_model(X, y)
    print("Model training completed.")
    
    print("Saving the trained model and feature names...")
    # Save the trained model and feature names
    save_model(model, 'vulnerability_predictor.pkl')
    joblib.dump(X.columns, 'feature_names.pkl')
    print("Model and feature names saved successfully.")
