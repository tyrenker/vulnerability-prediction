import pandas as pd

def preprocess_data(data):
    # List of columns to drop if they exist
    columns_to_drop = ['CVE_ID', 'description', 'published_date', 'last_modified_date']
    
    # Drop columns only if they exist in the DataFrame
    for col in columns_to_drop:
        if col in data.columns:
            data = data.drop(columns=[col])
    
    # One-hot encode categorical features if they exist
    categorical_features = ['access_vector', 'authentication', 'confidentiality_impact', 'integrity_impact', 'availability_impact', 'vendor', 'product', 'vulnerability_type']
    for feature in categorical_features:
        if feature in data.columns:
            data = pd.get_dummies(data, columns=[feature], drop_first=True)
    
    X = data.drop(columns=['exploit_exists'], errors='ignore')  # Drop 'exploit_exists' if it exists
    y = data['exploit_exists'] if 'exploit_exists' in data.columns else None
    
    return X, y
